目的：

1. 验证手机是否存在
2. 验证手机是否为用户持有
3. 防洪水攻击


逻辑：

1. 每次对同一手机发送验证码，要覆盖已有的验证码，刷新expiration
2. 验证码有过期时间，设置过期是出于空间考虑而非安全性
3. 每次加新记录，defer一个reaper
4. 每次服务器端验证通过，要删除该验证记录
5. 客户端和服务器都检查验证码？
6. expiration为5分钟（可配置）
7. 验证码有尝试失败次数限制（3次左右），如果超过次数，将失效
8. 验证成功，给凭证？（无法伪造，无法预测，算法透明，transient）：HMAC(mobile, code)
9. 如何防止HMAC重复利用？（有效期？）


或：
2. 验证码有过期时间，设置过期也是出于安全性考虑

4. 服务器端验证通过，要删除验证记录
5. 客户端对enhanced key进行验证，不走服务器

7. 验证码没有尝试失败次数限制
8. 客户端验证成功，只是放行提交表单
9. 提交表单时，明码提交
10. 提交时候，发现错误，立刻失效
11. 服务器级别的冷却时间
